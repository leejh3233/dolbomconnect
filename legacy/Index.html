<!DOCTYPE html>
<html>

<head>
    <base target="_top">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>ëŒë´„ë§¤íŠ¸ ê²¬ì  ë¬¸ì˜ | í”„ë¦¬ë¯¸ì—„ ì¸µê°„ì†ŒìŒ ì†”ë£¨ì…˜</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap"
        rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #f8f9fa;
            -webkit-overflow-scrolling: touch;
        }

        input,
        select,
        textarea {
            font-size: 16px !important;
        }

        /* ì¶”ê°€: ëª¨ë°”ì¼ í™•ëŒ€ ë°©ì§€ */
        .premium-shadow {
            box-shadow: 0 4px 20px -5px rgba(0, 0, 0, 0.1);
        }

        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
    </style>
</head>

<body class="bg-gradient-to-br from-blue-50 to-gray-100 min-h-[100dvh] flex items-center justify-center p-4">

    <div class="card w-full max-w-md bg-white rounded-3xl premium-shadow overflow-hidden relative border border-white">
        <!-- Top Banner -->
        <div class="bg-blue-600 px-6 py-4 text-white text-center">
            <div
                class="inline-block bg-blue-500 bg-opacity-30 rounded-full px-3 py-1 text-xs font-semibold mb-1 tracking-wide">
                âœ¨ í”„ë¦¬ë¯¸ì—„ ì¸µê°„ì†ŒìŒ ë§¤íŠ¸
            </div>
            <h2 class="text-xl font-bold tracking-tight">ëŒë´„ë§¤íŠ¸ ê°„í¸ ê²¬ì </h2>
        </div>

        <div class="p-8">
            <div class="text-center mb-8">
                <p class="text-gray-600 text-sm leading-relaxed">
                    ì•„ë˜ ë‚´ìš©ì„ ì…ë ¥í•˜ì‹œë©´ ìƒë‹´ ì •ë³´ê°€ ë³µì‚¬ë˜ì–´<br>
                    <b class="text-blue-600">ì¹´ì¹´ì˜¤í†¡ ì „ë¬¸ ìƒë‹´</b>ìœ¼ë¡œ ì¦‰ì‹œ ì—°ê²°ë©ë‹ˆë‹¤.
                </p>

                <!-- Benefit Badge (V12.4 Conditional) -->
                <? if (empId !== "ë³¸ì‚¬") { ?>
                <div class="mt-4 inline-flex items-center gap-2 bg-blue-50 border border-blue-100 px-4 py-2 rounded-lg">
                    <span class="flex h-2 w-2 relative">
                        <span
                            class="animate-ping absolute inline-flex h-full w-full rounded-full bg-blue-400 opacity-75"></span>
                        <span class="relative inline-flex rounded-full h-2 w-2 bg-blue-500"></span>
                    </span>
                    <span class="text-xs font-bold text-blue-700">ì‹œí¬ë¦¿ í˜œíƒ ì ìš©ì¤‘</span>
                </div>
                <? } else { ?>
                <div
                    class="mt-4 inline-flex items-center gap-2 bg-slate-50 border border-slate-100 px-4 py-2 rounded-lg">
                    <span class="text-xs font-bold text-slate-400">ì¼ë°˜ í˜œíƒ ì ìš©ì¤‘</span>
                </div>
                <? } ?>
            </div>

            <div class="space-y-4">
                <div>
                    <label class="block text-xs font-bold text-gray-500 mb-1 ml-1">ì§€ì—­</label>
                    <input type="text" id="area" placeholder="ì˜ˆ: ì„œìš¸, ë¶€ì‚°"
                        class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all text-sm">
                </div>
                <div>
                    <label class="block text-xs font-bold text-gray-500 mb-1 ml-1">ì•„íŒŒíŠ¸ëª…</label>
                    <input type="text" id="aptName" placeholder="ì˜ˆ: ë¡¯ë°ìºìŠ¬"
                        class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all text-sm">
                </div>
                <div>
                    <label class="block text-xs font-bold text-gray-500 mb-1 ml-1">í‰ìˆ˜</label>
                    <input type="text" id="pyeong" placeholder="ì˜ˆ: 34í‰"
                        class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all text-sm">
                </div>
                <div>
                    <label class="block text-xs font-bold text-gray-500 mb-1 ml-1">ì‹œê³µ í¬ë§ ë²”ìœ„</label>
                    <input type="text" id="scope" placeholder="ì˜ˆ: ê±°ì‹¤+ë³µë„"
                        class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all text-sm">
                </div>
                <div>
                    <label class="block text-xs font-bold text-gray-500 mb-1 ml-1">ì¶”ì²œì¸ (í• ì¸ í˜œíƒ í¬í•¨)</label>
                    <div class="relative">
                        <input type="text" id="empId" value="<?= empId ?>" readonly
                            class="w-full px-4 py-3 bg-blue-50 border border-blue-100 text-blue-800 font-bold rounded-xl focus:outline-none pointer-events-none text-sm">
                        <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                            <svg class="w-4 h-4 text-blue-500" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd"
                                    d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                                    clip-rule="evenodd"></path>
                            </svg>
                        </div>
                    </div>
                </div>
            </div>

            <button id="btnSubmit" onclick="submitForm()"
                class="w-full mt-8 bg-[#FEE500] hover:bg-[#FDD835] text-[#191919] font-bold py-4 rounded-xl shadow-sm transition-all transform active:scale-95 flex items-center justify-center gap-2 text-[16px]">
                <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor">
                    <path
                        d="M12 2C6.48 2 2 5.92 2 10.75c0 2.8 1.5 5.25 3.84 6.83-.16.6-.58 2.17-.66 2.5-.1.35.13.35.27.25.11-.08 1.57-1.07 2.18-1.5 1.55.45 3.2.7 4.9.7 5.52 0 10-3.92 10-8.75S15.52 2 12 2z" />
                </svg>
                ì¹´í†¡ ì±„ë„ ìƒë‹´ ë°”ë¡œê°€ê¸°
            </button>

            <p class="text-[11px] text-gray-400 text-center mt-4">
                *ì§€ê¸ˆ ë§í¬ë¡œ ì—°ê²°ì‹œ ì¶”ì²œì¸ í˜œíƒì´ ìë™ ì ìš©ë©ë‹ˆë‹¤.
            </p>
        </div>
    </div>

    <!-- Hidden Params & Script -->
    <script>
        // [Local Testing Mock]
        if (typeof google === 'undefined') {
            window.google = {
                script: {
                    run: {
                        withSuccessHandler: function (cb) {
                            return {
                                saveData: function (data) {
                                    console.log("Mock saveData called:", data);
                                    setTimeout(cb, 1000, "Success");
                                }
                            };
                        }
                    }
                }
            };
        }

        function submitForm() {
            var area = document.getElementById('area').value;
            var aptName = document.getElementById('aptName').value;
            var pyeong = document.getElementById('pyeong').value;
            var scope = document.getElementById('scope').value;
            var empId = document.getElementById('empId').value;
            var source = "<?= source ?>";

            if (!area || !aptName || !pyeong || !scope) {
                alert("ëª¨ë“  í•­ëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”! ğŸ˜Š");
                return;
            }

            // [ì‚¬ìš©ì ìš”ì²­ ë³µì‚¬ ë¬¸êµ¬: ìƒë‹´ ì •ë³´ ì¤„ë°”ê¿ˆ ë²„ì „]
            var copyText = "ğŸ  ëŒë´„ë§¤íŠ¸ ê²¬ì  ë¬¸ì˜ (ì¶”ì²œì¸ í˜œíƒ ì ìš©)\n\n" +
                "ğŸ“ ìƒë‹´ ì •ë³´\n" +
                "- ì§€ì—­: " + area + "\n" +
                "- ì•„íŒŒíŠ¸ëª…: " + aptName + "\n" +
                "- í‰ìˆ˜: " + pyeong + "\n" +
                "- ì‹œê³µë²”ìœ„: " + scope + "\n" +
                "- ì¶”ì²œì¸: " + empId + "\n\n" +
                "ğŸ í™•ë³´í•˜ì‹  ì¶”ì²œì¸ í˜œíƒ\n" +
                "âœ… ê³µêµ¬ê°€ ìë™ ì ìš©: ì¥ë‹¹ 15,500ì›\n" +
                "âœ… ì „ë¬¸ ì‹œê³µë¹„ í˜œíƒ: 300,000ì› ìƒë‹¹(100ì¥ì´ìƒ)\n" +
                "âœ… ì‹œí¬ë¦¿ ì¿ í°íŒ© ì¦ì •: 80,000ì› (ì›°ì»´3ë§Œ+ì¶”ì²œì¸5ë§Œ(ì§€ì¸ì¿ í°ì¤‘ë³µX))\n\n" +
                "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n" +
                "ìœ„ í˜œíƒìœ¼ë¡œ ìƒë‹´ ë¶€íƒë“œë¦½ë‹ˆë‹¤!";

            // 1. í´ë¦½ë³´ë“œ ë³µì‚¬
            navigator.clipboard.writeText(copyText);
            alert("ğŸ‰ ìƒë‹´ë‚´ìš©ì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!\nì¹´í†¡ì°½ì— 'ë¶™ì—¬ë„£ê¸°' í•˜ì‹œë©´ ì‹œí¬ë¦¿í˜œíƒ 8ë§Œì›ì´ ì ìš©ë©ë‹ˆë‹¤.");

            // 2. ë²„íŠ¼ ìƒíƒœ ë³€ê²½ ë° ìˆ˜ë™ ì—°ê²° ë§í¬ í™œì„±í™”
            var btn = document.getElementById('btnSubmit');
            var kakaoUrl = "https://pf.kakao.com/_UMyBK/chat";

            btn.innerHTML = `
            <svg class="w-5 h-5 animate-spin mr-2" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>
            ì—°ê²° ì¤‘... (ì•ˆë  ì‹œ í´ë¦­)
        `;
            btn.disabled = false;
            btn.onclick = function () { window.top.location.href = kakaoUrl; };

            var data = {
                area: area,
                aptName: aptName,
                pyeong: pyeong,
                scope: scope,
                empId: empId,
                source: source
            };

            // 3. ì„œë²„ ì €ì¥ í›„ ì¹´í†¡ ì´ë™ ì‹œë„
            google.script.run.withSuccessHandler(function () {
                window.top.location.href = kakaoUrl;
            }).saveData(data);
        }
    </script>
</body>

</html>